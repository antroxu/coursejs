<html>
   <head>
      <title>
         API itunes
      </title>
      <script language="javascript">

        var xmlHttp = new XMLHttpRequest();
        var JSon;
        var resultadoBusqueda;
        const DIR_SERV1 = "https://itunes.apple.com/search?term=";
        const DIR_SERV2 = "&media=music&limit=20";
        //10.1.2.10: La IP del server
        //8080: puerto... de todos los programas que tengo ern el server, el puerto identifica con que programa que quiero comunicar
        //appwebprofe: programa que voy a usar en el server. Se suele omitir porque solo hay uno
        //RegistrarPersona o ObtenerClave: metodo del programa que voy a usar


          /*
            Comentarios
          */

          function crearTabla(nFilas, nColumnas) {
            var body;
            var tabla;
            var fila;
            var columna;
            var texto;
            var imagen;
            var i;
            var j;

            body = document.getElementsByTagName("body")[0];

            tabla = document.createElement("table");

            tabla.border = 1;

            body.appendChild(tabla);

            for (i = 1; i <= nFilas; i++) {
                fila = document.createElement("tr");
                tabla.appendChild(fila);
                for (j = 1; j <= nColumnas; j++) {
                    columna = document.createElement("td");
                    fila.appendChild(columna);
                    imagen = document.createElement("img");
                    columna.appendChild(imagen);
                    imagen.src = "bandera1.png"
                }
            }

            return tabla;
        }

          function pintaCanciones()
          {
            var body;
            var tabla;
            var fila;
            var columna;
            var texto;
            var imagen;
            var i;

              if (xmlHttp.readyState === 4)
              {

                JSon = xmlHttp.responseText;
                resultadoBusqueda = JSON.parse(JSon);                
                
                body = document.getElementsByTagName("body")[0];
                tabla = document.createElement("table");
                body.appendChild(tabla);
                tabla.border = 1;

                for (i in resultadoBusqueda.results)
                {
                    fila = document.createElement("tr");
                    tabla.appendChild(fila);

                    //AÃ±ade artistName
                    columna = document.createElement("td");
                    fila.appendChild(columna);
                    console.log (resultadoBusqueda.results[i].artistName);


                    imagen = document.createElement("img");
                    columna.appendChild(imagen);
                    imagen.src = "bandera1.png"


                    console.log (i);
                    
                    console.log (resultadoBusqueda.results[i].trackId);
                    console.log (resultadoBusquedsa.results[i].artworkUrl100);
                    console.log (resultadoBusqueda.results[i].trackPrice);
                    console.log (resultadoBusqueda.results[i].currency);
                    console.log (resultadoBusqueda.results[i].previewUrl);



                                    fila = document.createElement("tr");
                tabla.appendChild(fila);
                for (j = 1; j <= nColumnas; j++) {
                    columna = document.createElement("td");
                    fila.appendChild(columna);
                    imagen = document.createElement("img");
                    columna.appendChild(imagen);
                    imagen.src = "bandera1.png"
                }

                    /*
                    artistViewUrl
                    artworkUrl30
                    artworkUrl60
                    artworkUrl100
                    collectionCensoredName
                    collectionExplicitness
                    collectionId
                    collectionName
                    collectionPrice
                    collectionViewUrl
                    country
                    currency
                    discCount
                    discNumber
                    isStreamable
                    kind
                    previewUrl
                    primaryGenreName
                    releaseDate
                    trackCensoredName
                    trackCount
                    trackExplicitness
                    trackId
                    trackName
                    trackNumber
                    trackPrice
                    trackTimeMillis
                    trackViewUrl
                    wrapperType
                    */






              }

          }

          function inicio()
          {
              
            var textoBusqueda = document.getElementById("cajaTextoBusqueda").value;

            console.log ("Busca -> " + textoBusqueda);

            //Hacer la llamada a itunes
            xmlHttp.onreadystatechange = pintaCanciones; //Funcion que sera llamada cuando haya respuesta
            xmlHttp.open('GET', DIR_SERV1 + textoBusqueda + DIR_SERV2, true); //true es que va a ser asincrono, casi siempre se pone true por que casi siempre es asincrono
            xmlHttp.send(null);

          }
         
      </script>
   </head>
   <body>
        <label for="textobusqueda">Introduce texto: </label>
        <input type="text" id="cajaTextoBusqueda"> </input> 
        <br><br>
        <button type="button" onclick="inicio()">Click para buscar en iTunes</button>
        <br><br>

       <!--

        <label for="Peso">Introduce Peso</label>
        <input type="number" id="cajaPeso"> </input>
        <br>

        <label for="Altura">Introduce Altura</label>
        <input type="number" id="cajaAltura"> </input>
        <br><br>

        <button type="button" onclick="main()">Click para calcular el IMC!!!</button>
        <br><br>

        <label for="IMC">IMC</label>
        <input type="number" id="cajaIMC"> </input>
        <br>

        <label for="clasificacionIMC">Clasificacion IMC</label>
        <input type="text" id="cajaClasificacionIMC"> </input>
        <br>

        <img src ="nada.png"id="imagenIMC"></img>






         //-->
   </body>
</html>